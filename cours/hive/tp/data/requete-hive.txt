CREATE EXTERNAL TABLE IF NOT EXISTS sales (  product_id String,  time_id String,  customer_id String,  promotion_id String,  store_id String,store_sales String,  store_cost String,  unit_sales String)  ROW FORMAT DELIMITED  FIELDS TERMINATED BY ';'  LINES TERMINATED BY '\n'  STORED AS TEXTFILE  LOCATION '/user/raj_ops/fbi/hive/sales.raw' ;

CREATE EXTERNAL TABLE IF NOT EXISTS sales_part (  product_id String,  time_id String,  customer_id String,  promotion_id String,  store_sales String,  store_cost String,  unit_sales String)  Partitioned by (store_id String)  ROW FORMAT DELIMITED  FIELDS TERMINATED BY ';'  LINES TERMINATED BY '\n'  STORED AS TEXTFILE  LOCATION '/user/raj_ops/fbi/hive/sales.raw' ;

INSERT INTO sales_part( select  product_id ,  time_id ,  customer_id ,  promotion_id,  store_sales ,  store_cost ,  unit_sales ,  store_id from sales );


create external table if not exists test ( name string, friends array<string>) row format delimited fields terminated by '|' STORED AS TEXTFILE  LOCATION '/user/raj_ops/fbi/hive1/sales1.raw' ;


WITH v_test_array AS (SELECT split(friends, "-") AS friiends      FROM test) SELECT friiends[0]   FROM v_test_array;











